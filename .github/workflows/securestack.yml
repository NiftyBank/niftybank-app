name: Perform Bloodhound Scans
on: [push]
jobs:
  Perform-Bloodhound-Scans:
    runs-on: ubuntu-latest
    container: securestackau/bloodhound-cli:latest
    steps:
      - name: Check out repository
        uses: actions/checkout@v2
        with:
          token: ${{ secrets.GITHUB_TOKEN }}
          fetch-depth: '0'
      - name: perform-secret-scan
        shell: bash
        env:
          BH_APP_ID: ad60440c-8215-478e-a553-8c1d172bf8e8
          BH_API_KEY: ${{ secrets.BH_API_KEY }}
          BH_SEVERITY: critical
        run:
          bloodhound-cli code -s
      - name: perform-code-scan
        shell: bash
        env:
          BH_APP_ID: ad60440c-8215-478e-a553-8c1d172bf8e8
          BH_API_KEY: ${{ secrets.BH_API_KEY }}
          BH_SEVERITY: critical
          BH_SCAN_TYPE: node
        run:
          bloodhound-cli code -t node -a $BH_APP_ID --info
      - name: perform-recon-scan
        shell: bash
        env:
          BH_APP_ID: ad60440c-8215-478e-a553-8c1d172bf8e8
          BH_API_KEY: ${{ secrets.BH_API_KEY }}
          BH_SEVERITY: critical
          BH_TARGET: app.niftybank.org
        run:
          bloodhound-cli recon -m -r -a $BH_APP_ID
